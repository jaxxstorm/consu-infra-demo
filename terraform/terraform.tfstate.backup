{
    "version": 3,
    "terraform_version": "0.11.10",
    "serial": 2,
    "lineage": "b4d4770b-a5fa-6e5b-e6e9-764a45c13d4c",
    "modules": [
        {
            "path": [
                "root"
            ],
            "outputs": {
                "consulserver_addresses": {
                    "sensitive": false,
                    "type": "list",
                    "value": [
                        "157.230.147.19",
                        "134.209.63.152",
                        "134.209.63.171"
                    ]
                },
                "puppetca_address": {
                    "sensitive": false,
                    "type": "list",
                    "value": [
                        "134.209.63.172"
                    ]
                },
                "puppetserver_addresses": {
                    "sensitive": false,
                    "type": "list",
                    "value": [
                        "134.209.63.170",
                        "134.209.63.173",
                        "157.230.147.37"
                    ]
                }
            },
            "resources": {
                "digitalocean_domain.default": {
                    "type": "digitalocean_domain",
                    "depends_on": [],
                    "primary": {
                        "id": "briggs.lan",
                        "attributes": {
                            "id": "briggs.lan",
                            "ip_address": "127.0.0.1",
                            "name": "briggs.lan"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                },
                "digitalocean_ssh_key.personal": {
                    "type": "digitalocean_ssh_key",
                    "depends_on": [],
                    "primary": {
                        "id": "24137497",
                        "attributes": {
                            "fingerprint": "63:a2:8c:46:73:cb:60:38:52:37:e2:f9:74:41:65:42",
                            "id": "24137497",
                            "name": "personal_key",
                            "public_key": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDhI2N7owvPzsjZqgzxmNBfAfJ1/oZQG17+p6CIyUNtov+L58Cq03AwyG9yeW7JVsj5Fm85ALosMO32yRh6XM/9VHnomMw9n1fX/ZbQLM+rXp1y9O03RK+YGA1tlYWhQKjdUJw3VTT+60PG5aOiSC4GkLZG1ip6N0wOufhKOQ6nAR156WFDlc2oxBc6PXlm9uj4STpFVT91f0T9VeDh273+iA2KRo9GMzpiaD+3z6aIBGJawxzhMxTIedPYNHAQlBESc+8H4RqAEPt2x7yQWs0loqOWLpxwGEpXPanuA1MXfk5xxUOAsRTyEOrpNYCky6xWgFHHEsj3frcJZAfHQh3B lee@LONGB0003.local"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "consulserver"
            ],
            "outputs": {
                "addresses": {
                    "sensitive": false,
                    "type": "list",
                    "value": [
                        "157.230.147.19",
                        "134.209.63.152",
                        "134.209.63.171"
                    ]
                },
                "ids": {
                    "sensitive": false,
                    "type": "list",
                    "value": [
                        "135143913",
                        "135143914",
                        "135143919"
                    ]
                },
                "names": {
                    "sensitive": false,
                    "type": "list",
                    "value": [
                        "consulserver-0",
                        "consulserver-1",
                        "consulserver-2"
                    ]
                }
            },
            "resources": {
                "data.template_file.consulserver_user_data.0": {
                    "type": "template_file",
                    "depends_on": [],
                    "primary": {
                        "id": "87a5e74b54a3d9addf07e386a9206f255b78a328ea2263776d9acea97417e734",
                        "attributes": {
                            "id": "87a5e74b54a3d9addf07e386a9206f255b78a328ea2263776d9acea97417e734",
                            "rendered": "#cloud-config\nhostname: \"consulserver-0.briggs.lan\"\nfqdn: \"consulserver-0.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm \n  - yum install -y puppet-agent\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = consulserver-0.briggs.lan\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=consul.service.consul,vault.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=consulserver\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "template": "#cloud-config\nhostname: \"${fqdn}\"\nfqdn: \"${fqdn}\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm \n  - yum install -y puppet-agent\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = ${fqdn}\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=consul.service.consul,vault.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.${domain}; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=consulserver\n      domain=${domain}\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vars.%": "3",
                            "vars.domain": "briggs.lan",
                            "vars.fqdn": "consulserver-0.briggs.lan",
                            "vars.hostname": "consulserver-0"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.template"
                },
                "data.template_file.consulserver_user_data.1": {
                    "type": "template_file",
                    "depends_on": [],
                    "primary": {
                        "id": "c71a7a6e58ee07504157c26488d59ab7c426dac215b8fccefe8543b7f3cdce03",
                        "attributes": {
                            "id": "c71a7a6e58ee07504157c26488d59ab7c426dac215b8fccefe8543b7f3cdce03",
                            "rendered": "#cloud-config\nhostname: \"consulserver-1.briggs.lan\"\nfqdn: \"consulserver-1.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm \n  - yum install -y puppet-agent\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = consulserver-1.briggs.lan\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=consul.service.consul,vault.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=consulserver\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "template": "#cloud-config\nhostname: \"${fqdn}\"\nfqdn: \"${fqdn}\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm \n  - yum install -y puppet-agent\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = ${fqdn}\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=consul.service.consul,vault.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.${domain}; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=consulserver\n      domain=${domain}\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vars.%": "3",
                            "vars.domain": "briggs.lan",
                            "vars.fqdn": "consulserver-1.briggs.lan",
                            "vars.hostname": "consulserver-1"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.template"
                },
                "data.template_file.consulserver_user_data.2": {
                    "type": "template_file",
                    "depends_on": [],
                    "primary": {
                        "id": "62dd1f4ae36894ff74a12ec85437f91aeaea5eb7f59bd4c4cf9051ceca6c8bf0",
                        "attributes": {
                            "id": "62dd1f4ae36894ff74a12ec85437f91aeaea5eb7f59bd4c4cf9051ceca6c8bf0",
                            "rendered": "#cloud-config\nhostname: \"consulserver-2.briggs.lan\"\nfqdn: \"consulserver-2.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm \n  - yum install -y puppet-agent\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = consulserver-2.briggs.lan\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=consul.service.consul,vault.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=consulserver\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "template": "#cloud-config\nhostname: \"${fqdn}\"\nfqdn: \"${fqdn}\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm \n  - yum install -y puppet-agent\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = ${fqdn}\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=consul.service.consul,vault.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.${domain}; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=consulserver\n      domain=${domain}\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vars.%": "3",
                            "vars.domain": "briggs.lan",
                            "vars.fqdn": "consulserver-2.briggs.lan",
                            "vars.hostname": "consulserver-2"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.template"
                },
                "digitalocean_droplet.consulserver.0": {
                    "type": "digitalocean_droplet",
                    "depends_on": [
                        "data.template_file.consulserver_user_data.*"
                    ],
                    "primary": {
                        "id": "135143913",
                        "attributes": {
                            "disk": "30",
                            "id": "135143913",
                            "image": "centos-7-x64",
                            "ipv4_address": "157.230.147.19",
                            "ipv4_address_private": "10.138.38.88",
                            "locked": "false",
                            "name": "consulserver-0",
                            "price_hourly": "0.01488",
                            "price_monthly": "10",
                            "private_networking": "true",
                            "region": "sfo2",
                            "resize_disk": "true",
                            "size": "1gb",
                            "ssh_keys.#": "1",
                            "ssh_keys.0": "24137497",
                            "status": "active",
                            "tags.#": "0",
                            "user_data": "#cloud-config\nhostname: \"consulserver-0.briggs.lan\"\nfqdn: \"consulserver-0.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm \n  - yum install -y puppet-agent\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = consulserver-0.briggs.lan\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=consul.service.consul,vault.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=consulserver\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vcpus": "1"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                },
                "digitalocean_droplet.consulserver.1": {
                    "type": "digitalocean_droplet",
                    "depends_on": [
                        "data.template_file.consulserver_user_data.*"
                    ],
                    "primary": {
                        "id": "135143914",
                        "attributes": {
                            "disk": "30",
                            "id": "135143914",
                            "image": "centos-7-x64",
                            "ipv4_address": "134.209.63.152",
                            "ipv4_address_private": "10.138.230.157",
                            "locked": "false",
                            "name": "consulserver-1",
                            "price_hourly": "0.01488",
                            "price_monthly": "10",
                            "private_networking": "true",
                            "region": "sfo2",
                            "resize_disk": "true",
                            "size": "1gb",
                            "ssh_keys.#": "1",
                            "ssh_keys.0": "24137497",
                            "status": "active",
                            "tags.#": "0",
                            "user_data": "#cloud-config\nhostname: \"consulserver-1.briggs.lan\"\nfqdn: \"consulserver-1.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm \n  - yum install -y puppet-agent\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = consulserver-1.briggs.lan\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=consul.service.consul,vault.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=consulserver\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vcpus": "1"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                },
                "digitalocean_droplet.consulserver.2": {
                    "type": "digitalocean_droplet",
                    "depends_on": [
                        "data.template_file.consulserver_user_data.*"
                    ],
                    "primary": {
                        "id": "135143919",
                        "attributes": {
                            "disk": "30",
                            "id": "135143919",
                            "image": "centos-7-x64",
                            "ipv4_address": "134.209.63.171",
                            "ipv4_address_private": "10.138.230.207",
                            "locked": "false",
                            "name": "consulserver-2",
                            "price_hourly": "0.01488",
                            "price_monthly": "10",
                            "private_networking": "true",
                            "region": "sfo2",
                            "resize_disk": "true",
                            "size": "1gb",
                            "ssh_keys.#": "1",
                            "ssh_keys.0": "24137497",
                            "status": "active",
                            "tags.#": "0",
                            "user_data": "#cloud-config\nhostname: \"consulserver-2.briggs.lan\"\nfqdn: \"consulserver-2.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm \n  - yum install -y puppet-agent\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = consulserver-2.briggs.lan\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=consul.service.consul,vault.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=consulserver\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vcpus": "1"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                },
                "digitalocean_record.consulserver.0": {
                    "type": "digitalocean_record",
                    "depends_on": [
                        "digitalocean_droplet.consulserver.*"
                    ],
                    "primary": {
                        "id": "66773724",
                        "attributes": {
                            "domain": "briggs.lan",
                            "fqdn": "consulserver-0.briggs.lan",
                            "id": "66773724",
                            "name": "consulserver-0",
                            "port": "0",
                            "priority": "0",
                            "ttl": "1800",
                            "type": "A",
                            "value": "10.138.38.88",
                            "weight": "0"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                },
                "digitalocean_record.consulserver.1": {
                    "type": "digitalocean_record",
                    "depends_on": [
                        "digitalocean_droplet.consulserver.*"
                    ],
                    "primary": {
                        "id": "66773725",
                        "attributes": {
                            "domain": "briggs.lan",
                            "fqdn": "consulserver-1.briggs.lan",
                            "id": "66773725",
                            "name": "consulserver-1",
                            "port": "0",
                            "priority": "0",
                            "ttl": "1800",
                            "type": "A",
                            "value": "10.138.230.157",
                            "weight": "0"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                },
                "digitalocean_record.consulserver.2": {
                    "type": "digitalocean_record",
                    "depends_on": [
                        "digitalocean_droplet.consulserver.*"
                    ],
                    "primary": {
                        "id": "66773723",
                        "attributes": {
                            "domain": "briggs.lan",
                            "fqdn": "consulserver-2.briggs.lan",
                            "id": "66773723",
                            "name": "consulserver-2",
                            "port": "0",
                            "priority": "0",
                            "ttl": "1800",
                            "type": "A",
                            "value": "10.138.230.207",
                            "weight": "0"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "puppet_ca"
            ],
            "outputs": {
                "addresses": {
                    "sensitive": false,
                    "type": "list",
                    "value": [
                        "134.209.63.172"
                    ]
                },
                "id": {
                    "sensitive": false,
                    "type": "list",
                    "value": [
                        "135143918"
                    ]
                },
                "name": {
                    "sensitive": false,
                    "type": "list",
                    "value": [
                        "puppetserver-0"
                    ]
                }
            },
            "resources": {
                "data.template_file.puppetca_user_data": {
                    "type": "template_file",
                    "depends_on": [],
                    "primary": {
                        "id": "0b243f8beeccab9f890193ff7f19051ed4b28164326e97076c13ee6f5767d1a8",
                        "attributes": {
                            "id": "0b243f8beeccab9f890193ff7f19051ed4b28164326e97076c13ee6f5767d1a8",
                            "rendered": "#cloud-config\nhostname: \"puppetserver-0.briggs.lan\"\nfqdn: \"puppetserver-0.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: true\n    gpgcheck: false\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\n  - yum install -y puppetserver\n  - gem install --no-ri --no-rdoc r10k\n  - sed -i 's/2g/512m/g' /etc/sysconfig/puppetserver\n  - sed -i '/\\[main\\]/a dns_alt_names=puppetserver-0.briggs.lan,puppetserver.service.consul,ca.puppetserver.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a ca=true' /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a autosign=true' /etc/puppetlabs/puppet/puppet.conf\n  - sed -i 's|/opt/puppetlabs/puppet/lib/ruby/vendor_ruby|/opt/puppetlabs/puppet/lib/ruby/vendor_ruby,/opt/puppetlabs/puppet/cache/lib|g' /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf\n  - systemctl start puppetserver.service\n  - systemctl enable puppetserver.service\n  - mkdir -p /etc/facter/facts.d\n  - r10k deploy environment -p --verbose -c /etc/puppetlabs/r10k.yaml\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\n\nwrite_files:\n  - path: /etc/puppetlabs/r10k.yaml\n    content: |\n      # The location to use for storing cached Git repos\n      :cachedir: '/opt/puppetlabs/r10k/cache'\n\n      # A list of git repositories to create\n      :sources:\n        # This will clone the git repository and instantiate an environment per\n        # branch in /etc/puppetlabs/code/environments\n        :github:\n          remote: 'https://github.com/jaxxstorm/puppet-consul-demo.git'\n          basedir: '/etc/puppetlabs/code/environments'\n  - path: /etc/puppetlabs/puppet/autosign.conf\n    content: |\n      *.briggs.lan\n      puppetserver.service.consul\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=puppetca\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "template": "#cloud-config\nhostname: \"${fqdn}\"\nfqdn: \"${fqdn}\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: true\n    gpgcheck: false\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\n  - yum install -y puppetserver\n  - gem install --no-ri --no-rdoc r10k\n  - sed -i 's/2g/512m/g' /etc/sysconfig/puppetserver\n  - sed -i '/\\[main\\]/a dns_alt_names=puppetserver-0.${domain},puppetserver.service.consul,ca.puppetserver.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a ca=true' /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a autosign=true' /etc/puppetlabs/puppet/puppet.conf\n  - sed -i 's|/opt/puppetlabs/puppet/lib/ruby/vendor_ruby|/opt/puppetlabs/puppet/lib/ruby/vendor_ruby,/opt/puppetlabs/puppet/cache/lib|g' /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf\n  - systemctl start puppetserver.service\n  - systemctl enable puppetserver.service\n  - mkdir -p /etc/facter/facts.d\n  - r10k deploy environment -p --verbose -c /etc/puppetlabs/r10k.yaml\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.${domain}; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\n\nwrite_files:\n  - path: /etc/puppetlabs/r10k.yaml\n    content: |\n      # The location to use for storing cached Git repos\n      :cachedir: '/opt/puppetlabs/r10k/cache'\n\n      # A list of git repositories to create\n      :sources:\n        # This will clone the git repository and instantiate an environment per\n        # branch in /etc/puppetlabs/code/environments\n        :github:\n          remote: 'https://github.com/jaxxstorm/puppet-consul-demo.git'\n          basedir: '/etc/puppetlabs/code/environments'\n  - path: /etc/puppetlabs/puppet/autosign.conf\n    content: |\n      *.${domain}\n      puppetserver.service.consul\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=puppetca\n      domain=${domain}\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vars.%": "3",
                            "vars.domain": "briggs.lan",
                            "vars.fqdn": "puppetserver-0.briggs.lan",
                            "vars.hostname": "puppetserver-0"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.template"
                },
                "digitalocean_droplet.puppet_ca": {
                    "type": "digitalocean_droplet",
                    "depends_on": [
                        "data.template_file.puppetca_user_data.*"
                    ],
                    "primary": {
                        "id": "135143918",
                        "attributes": {
                            "disk": "40",
                            "id": "135143918",
                            "image": "centos-7-x64",
                            "ipv4_address": "134.209.63.172",
                            "ipv4_address_private": "10.138.230.209",
                            "locked": "false",
                            "name": "puppetserver-0",
                            "price_hourly": "0.02976",
                            "price_monthly": "20",
                            "private_networking": "true",
                            "region": "sfo2",
                            "resize_disk": "true",
                            "size": "2gb",
                            "ssh_keys.#": "1",
                            "ssh_keys.0": "24137497",
                            "status": "active",
                            "tags.#": "0",
                            "user_data": "#cloud-config\nhostname: \"puppetserver-0.briggs.lan\"\nfqdn: \"puppetserver-0.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: true\n    gpgcheck: false\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\n  - yum install -y puppetserver\n  - gem install --no-ri --no-rdoc r10k\n  - sed -i 's/2g/512m/g' /etc/sysconfig/puppetserver\n  - sed -i '/\\[main\\]/a dns_alt_names=puppetserver-0.briggs.lan,puppetserver.service.consul,ca.puppetserver.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a ca=true' /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a autosign=true' /etc/puppetlabs/puppet/puppet.conf\n  - sed -i 's|/opt/puppetlabs/puppet/lib/ruby/vendor_ruby|/opt/puppetlabs/puppet/lib/ruby/vendor_ruby,/opt/puppetlabs/puppet/cache/lib|g' /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf\n  - systemctl start puppetserver.service\n  - systemctl enable puppetserver.service\n  - mkdir -p /etc/facter/facts.d\n  - r10k deploy environment -p --verbose -c /etc/puppetlabs/r10k.yaml\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\n\nwrite_files:\n  - path: /etc/puppetlabs/r10k.yaml\n    content: |\n      # The location to use for storing cached Git repos\n      :cachedir: '/opt/puppetlabs/r10k/cache'\n\n      # A list of git repositories to create\n      :sources:\n        # This will clone the git repository and instantiate an environment per\n        # branch in /etc/puppetlabs/code/environments\n        :github:\n          remote: 'https://github.com/jaxxstorm/puppet-consul-demo.git'\n          basedir: '/etc/puppetlabs/code/environments'\n  - path: /etc/puppetlabs/puppet/autosign.conf\n    content: |\n      *.briggs.lan\n      puppetserver.service.consul\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=puppetca\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vcpus": "2"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                },
                "digitalocean_record.puppetca": {
                    "type": "digitalocean_record",
                    "depends_on": [
                        "digitalocean_droplet.puppet_ca.*"
                    ],
                    "primary": {
                        "id": "66773726",
                        "attributes": {
                            "domain": "briggs.lan",
                            "fqdn": "puppetserver-0.briggs.lan",
                            "id": "66773726",
                            "name": "puppetserver-0",
                            "port": "0",
                            "priority": "0",
                            "ttl": "1800",
                            "type": "A",
                            "value": "10.138.230.209",
                            "weight": "0"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                }
            },
            "depends_on": []
        },
        {
            "path": [
                "root",
                "puppetserver"
            ],
            "outputs": {
                "addresses": {
                    "sensitive": false,
                    "type": "list",
                    "value": [
                        "134.209.63.170",
                        "134.209.63.173",
                        "157.230.147.37"
                    ]
                },
                "ids": {
                    "sensitive": false,
                    "type": "list",
                    "value": [
                        "135143920",
                        "135143917",
                        "135143912"
                    ]
                },
                "names": {
                    "sensitive": false,
                    "type": "list",
                    "value": [
                        "puppetserver-1",
                        "puppetserver-2",
                        "puppetserver-3"
                    ]
                }
            },
            "resources": {
                "data.template_file.puppetserver_user_data.0": {
                    "type": "template_file",
                    "depends_on": [],
                    "primary": {
                        "id": "b9e048f439de82ddefa2b4ff127b45df601782884d24e56f166f9eac32fe1700",
                        "attributes": {
                            "id": "b9e048f439de82ddefa2b4ff127b45df601782884d24e56f166f9eac32fe1700",
                            "rendered": "#cloud-config\nhostname: \"puppetserver-1.briggs.lan\"\nfqdn: \"puppetserver-1.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\n  - yum install -y puppetserver\n  - sed -i 's/2g/512m/g' /etc/sysconfig/puppetserver\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = puppetserver-1.briggs.lan\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=puppet.service.consul,puppetserver.service.consul,puppetmaster.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/puppetlabs/r10k.yaml\n    content: |\n      # The location to use for storing cached Git repos\n      :cachedir: '/opt/puppetlabs/r10k/cache'\n\n      # A list of git repositories to create\n      :sources:\n        # This will clone the git repository and instantiate an environment per\n        # branch in /etc/puppetlabs/code/environments\n        :github:\n          remote: 'https://github.com/jaxxstorm/puppet-consul-demo.git'\n          basedir: '/etc/puppetlabs/code/environments'\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=puppetserver\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "template": "#cloud-config\nhostname: \"${fqdn}\"\nfqdn: \"${fqdn}\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\n  - yum install -y puppetserver\n  - sed -i 's/2g/512m/g' /etc/sysconfig/puppetserver\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = ${fqdn}\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=puppet.service.consul,puppetserver.service.consul,puppetmaster.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.${domain}; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/puppetlabs/r10k.yaml\n    content: |\n      # The location to use for storing cached Git repos\n      :cachedir: '/opt/puppetlabs/r10k/cache'\n\n      # A list of git repositories to create\n      :sources:\n        # This will clone the git repository and instantiate an environment per\n        # branch in /etc/puppetlabs/code/environments\n        :github:\n          remote: 'https://github.com/jaxxstorm/puppet-consul-demo.git'\n          basedir: '/etc/puppetlabs/code/environments'\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=puppetserver\n      domain=${domain}\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vars.%": "3",
                            "vars.domain": "briggs.lan",
                            "vars.fqdn": "puppetserver-1.briggs.lan",
                            "vars.hostname": "puppetserver-1"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.template"
                },
                "data.template_file.puppetserver_user_data.1": {
                    "type": "template_file",
                    "depends_on": [],
                    "primary": {
                        "id": "5769ab96b119990408156d09facb9b26f1295b6fbc575a56f9074a12537e2d2b",
                        "attributes": {
                            "id": "5769ab96b119990408156d09facb9b26f1295b6fbc575a56f9074a12537e2d2b",
                            "rendered": "#cloud-config\nhostname: \"puppetserver-2.briggs.lan\"\nfqdn: \"puppetserver-2.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\n  - yum install -y puppetserver\n  - sed -i 's/2g/512m/g' /etc/sysconfig/puppetserver\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = puppetserver-2.briggs.lan\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=puppet.service.consul,puppetserver.service.consul,puppetmaster.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/puppetlabs/r10k.yaml\n    content: |\n      # The location to use for storing cached Git repos\n      :cachedir: '/opt/puppetlabs/r10k/cache'\n\n      # A list of git repositories to create\n      :sources:\n        # This will clone the git repository and instantiate an environment per\n        # branch in /etc/puppetlabs/code/environments\n        :github:\n          remote: 'https://github.com/jaxxstorm/puppet-consul-demo.git'\n          basedir: '/etc/puppetlabs/code/environments'\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=puppetserver\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "template": "#cloud-config\nhostname: \"${fqdn}\"\nfqdn: \"${fqdn}\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\n  - yum install -y puppetserver\n  - sed -i 's/2g/512m/g' /etc/sysconfig/puppetserver\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = ${fqdn}\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=puppet.service.consul,puppetserver.service.consul,puppetmaster.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.${domain}; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/puppetlabs/r10k.yaml\n    content: |\n      # The location to use for storing cached Git repos\n      :cachedir: '/opt/puppetlabs/r10k/cache'\n\n      # A list of git repositories to create\n      :sources:\n        # This will clone the git repository and instantiate an environment per\n        # branch in /etc/puppetlabs/code/environments\n        :github:\n          remote: 'https://github.com/jaxxstorm/puppet-consul-demo.git'\n          basedir: '/etc/puppetlabs/code/environments'\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=puppetserver\n      domain=${domain}\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vars.%": "3",
                            "vars.domain": "briggs.lan",
                            "vars.fqdn": "puppetserver-2.briggs.lan",
                            "vars.hostname": "puppetserver-2"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.template"
                },
                "data.template_file.puppetserver_user_data.2": {
                    "type": "template_file",
                    "depends_on": [],
                    "primary": {
                        "id": "2f629eb3782f66a502c49290b1d1191fb68342ad00c89bdfe03dc1848b6dbe97",
                        "attributes": {
                            "id": "2f629eb3782f66a502c49290b1d1191fb68342ad00c89bdfe03dc1848b6dbe97",
                            "rendered": "#cloud-config\nhostname: \"puppetserver-3.briggs.lan\"\nfqdn: \"puppetserver-3.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\n  - yum install -y puppetserver\n  - sed -i 's/2g/512m/g' /etc/sysconfig/puppetserver\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = puppetserver-3.briggs.lan\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=puppet.service.consul,puppetserver.service.consul,puppetmaster.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/puppetlabs/r10k.yaml\n    content: |\n      # The location to use for storing cached Git repos\n      :cachedir: '/opt/puppetlabs/r10k/cache'\n\n      # A list of git repositories to create\n      :sources:\n        # This will clone the git repository and instantiate an environment per\n        # branch in /etc/puppetlabs/code/environments\n        :github:\n          remote: 'https://github.com/jaxxstorm/puppet-consul-demo.git'\n          basedir: '/etc/puppetlabs/code/environments'\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=puppetserver\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "template": "#cloud-config\nhostname: \"${fqdn}\"\nfqdn: \"${fqdn}\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\n  - yum install -y puppetserver\n  - sed -i 's/2g/512m/g' /etc/sysconfig/puppetserver\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = ${fqdn}\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=puppet.service.consul,puppetserver.service.consul,puppetmaster.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.${domain}; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/puppetlabs/r10k.yaml\n    content: |\n      # The location to use for storing cached Git repos\n      :cachedir: '/opt/puppetlabs/r10k/cache'\n\n      # A list of git repositories to create\n      :sources:\n        # This will clone the git repository and instantiate an environment per\n        # branch in /etc/puppetlabs/code/environments\n        :github:\n          remote: 'https://github.com/jaxxstorm/puppet-consul-demo.git'\n          basedir: '/etc/puppetlabs/code/environments'\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=puppetserver\n      domain=${domain}\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vars.%": "3",
                            "vars.domain": "briggs.lan",
                            "vars.fqdn": "puppetserver-3.briggs.lan",
                            "vars.hostname": "puppetserver-3"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.template"
                },
                "digitalocean_droplet.puppetserver.0": {
                    "type": "digitalocean_droplet",
                    "depends_on": [
                        "data.template_file.puppetserver_user_data.*"
                    ],
                    "primary": {
                        "id": "135143920",
                        "attributes": {
                            "disk": "40",
                            "id": "135143920",
                            "image": "centos-7-x64",
                            "ipv4_address": "134.209.63.170",
                            "ipv4_address_private": "10.138.230.206",
                            "locked": "false",
                            "name": "puppetserver-1",
                            "price_hourly": "0.02976",
                            "price_monthly": "20",
                            "private_networking": "true",
                            "region": "sfo2",
                            "resize_disk": "true",
                            "size": "2gb",
                            "ssh_keys.#": "1",
                            "ssh_keys.0": "24137497",
                            "status": "active",
                            "tags.#": "0",
                            "user_data": "#cloud-config\nhostname: \"puppetserver-1.briggs.lan\"\nfqdn: \"puppetserver-1.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\n  - yum install -y puppetserver\n  - sed -i 's/2g/512m/g' /etc/sysconfig/puppetserver\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = puppetserver-1.briggs.lan\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=puppet.service.consul,puppetserver.service.consul,puppetmaster.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/puppetlabs/r10k.yaml\n    content: |\n      # The location to use for storing cached Git repos\n      :cachedir: '/opt/puppetlabs/r10k/cache'\n\n      # A list of git repositories to create\n      :sources:\n        # This will clone the git repository and instantiate an environment per\n        # branch in /etc/puppetlabs/code/environments\n        :github:\n          remote: 'https://github.com/jaxxstorm/puppet-consul-demo.git'\n          basedir: '/etc/puppetlabs/code/environments'\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=puppetserver\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vcpus": "2"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                },
                "digitalocean_droplet.puppetserver.1": {
                    "type": "digitalocean_droplet",
                    "depends_on": [
                        "data.template_file.puppetserver_user_data.*"
                    ],
                    "primary": {
                        "id": "135143917",
                        "attributes": {
                            "disk": "40",
                            "id": "135143917",
                            "image": "centos-7-x64",
                            "ipv4_address": "134.209.63.173",
                            "ipv4_address_private": "10.138.230.214",
                            "locked": "false",
                            "name": "puppetserver-2",
                            "price_hourly": "0.02976",
                            "price_monthly": "20",
                            "private_networking": "true",
                            "region": "sfo2",
                            "resize_disk": "true",
                            "size": "2gb",
                            "ssh_keys.#": "1",
                            "ssh_keys.0": "24137497",
                            "status": "active",
                            "tags.#": "0",
                            "user_data": "#cloud-config\nhostname: \"puppetserver-2.briggs.lan\"\nfqdn: \"puppetserver-2.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\n  - yum install -y puppetserver\n  - sed -i 's/2g/512m/g' /etc/sysconfig/puppetserver\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = puppetserver-2.briggs.lan\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=puppet.service.consul,puppetserver.service.consul,puppetmaster.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/puppetlabs/r10k.yaml\n    content: |\n      # The location to use for storing cached Git repos\n      :cachedir: '/opt/puppetlabs/r10k/cache'\n\n      # A list of git repositories to create\n      :sources:\n        # This will clone the git repository and instantiate an environment per\n        # branch in /etc/puppetlabs/code/environments\n        :github:\n          remote: 'https://github.com/jaxxstorm/puppet-consul-demo.git'\n          basedir: '/etc/puppetlabs/code/environments'\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=puppetserver\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vcpus": "2"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                },
                "digitalocean_droplet.puppetserver.2": {
                    "type": "digitalocean_droplet",
                    "depends_on": [
                        "data.template_file.puppetserver_user_data.*"
                    ],
                    "primary": {
                        "id": "135143912",
                        "attributes": {
                            "disk": "40",
                            "id": "135143912",
                            "image": "centos-7-x64",
                            "ipv4_address": "157.230.147.37",
                            "ipv4_address_private": "10.138.230.79",
                            "locked": "false",
                            "name": "puppetserver-3",
                            "price_hourly": "0.02976",
                            "price_monthly": "20",
                            "private_networking": "true",
                            "region": "sfo2",
                            "resize_disk": "true",
                            "size": "2gb",
                            "ssh_keys.#": "1",
                            "ssh_keys.0": "24137497",
                            "status": "active",
                            "tags.#": "0",
                            "user_data": "#cloud-config\nhostname: \"puppetserver-3.briggs.lan\"\nfqdn: \"puppetserver-3.briggs.lan\"\n\nyum_repos:\n  puppet:\n    baseurl: https://yum.puppetlabs.com/el/7/PC1/x86_64/\n    enabled: 1\n    gpgcheck: 0\n    name: PuppetLabs\n\npackages:\n  - ruby\n  - ruby-devel\n  - git\n  - vim\n  - bind-utils\n \nruncmd:\n  - yum install -y https://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\n  - yum install -y puppetserver\n  - sed -i 's/2g/512m/g' /etc/sysconfig/puppetserver\n  - mkdir -p /etc/facter/facts.d\n  - echo -e \"nameserver 173.245.58.51\\nnameserver 8.8.8.8\" \u003e /etc/resolv.conf\n  - echo -e \"[main]\\ncertname = puppetserver-3.briggs.lan\" \u003e\u003e /etc/puppetlabs/puppet/puppet.conf\n  - sed -i '/\\[main\\]/a dns_alt_names=puppet.service.consul,puppetserver.service.consul,puppetmaster.service.consul' /etc/puppetlabs/puppet/puppet.conf\n  - until /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; do echo \"puppet failed, retry in 10 seconds\"; sleep 10; done\n  - until grep \"@8600\" /etc/unbound/unbound.conf; do echo \"Consul still not configured, retry in 10 seconds\"; sleep 10; /opt/puppetlabs/puppet/bin/puppet agent -t --environment=develop --server=puppetserver-0.briggs.lan; done\n\nwrite_files:\n  - path: /etc/puppetlabs/r10k.yaml\n    content: |\n      # The location to use for storing cached Git repos\n      :cachedir: '/opt/puppetlabs/r10k/cache'\n\n      # A list of git repositories to create\n      :sources:\n        # This will clone the git repository and instantiate an environment per\n        # branch in /etc/puppetlabs/code/environments\n        :github:\n          remote: 'https://github.com/jaxxstorm/puppet-consul-demo.git'\n          basedir: '/etc/puppetlabs/code/environments'\n  - path: /etc/facter/facts.d/role.txt\n    content: |\n      role=puppetserver\n      domain=briggs.lan\n\noutput:\n  all: \"\u003e\u003e /var/log/cloud-init.log\"\n",
                            "vcpus": "2"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                },
                "digitalocean_record.puppetserver.0": {
                    "type": "digitalocean_record",
                    "depends_on": [
                        "digitalocean_droplet.puppetserver.*"
                    ],
                    "primary": {
                        "id": "66773734",
                        "attributes": {
                            "domain": "briggs.lan",
                            "fqdn": "puppetserver-1.briggs.lan",
                            "id": "66773734",
                            "name": "puppetserver-1",
                            "port": "0",
                            "priority": "0",
                            "ttl": "1800",
                            "type": "A",
                            "value": "10.138.230.206",
                            "weight": "0"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                },
                "digitalocean_record.puppetserver.1": {
                    "type": "digitalocean_record",
                    "depends_on": [
                        "digitalocean_droplet.puppetserver.*"
                    ],
                    "primary": {
                        "id": "66773733",
                        "attributes": {
                            "domain": "briggs.lan",
                            "fqdn": "puppetserver-2.briggs.lan",
                            "id": "66773733",
                            "name": "puppetserver-2",
                            "port": "0",
                            "priority": "0",
                            "ttl": "1800",
                            "type": "A",
                            "value": "10.138.230.214",
                            "weight": "0"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                },
                "digitalocean_record.puppetserver.2": {
                    "type": "digitalocean_record",
                    "depends_on": [
                        "digitalocean_droplet.puppetserver.*"
                    ],
                    "primary": {
                        "id": "66773735",
                        "attributes": {
                            "domain": "briggs.lan",
                            "fqdn": "puppetserver-3.briggs.lan",
                            "id": "66773735",
                            "name": "puppetserver-3",
                            "port": "0",
                            "priority": "0",
                            "ttl": "1800",
                            "type": "A",
                            "value": "10.138.230.79",
                            "weight": "0"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.digitalocean"
                }
            },
            "depends_on": []
        }
    ]
}
